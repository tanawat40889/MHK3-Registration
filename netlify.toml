[build]
  command = "npm run build"
  publish = "dist"
  functions = "netlify/functions"

[build.environment]
  NODE_VERSION = "20"
  # Ensure optional native deps (e.g. Rollup platform binaries) are installed.
  NPM_FLAGS = "--include=optional"

[[redirects]]
  from = "/api/health"
  to = "/.netlify/functions/health"
  status = 200

[[redirects]]
  from = "/api/notion/search"
  to = "/.netlify/functions/notion-search"
  status = 200

[[redirects]]
  from = "/api/notion/scan"
  to = "/.netlify/functions/notion-scan"
  status = 200

[[redirects]]
  from = "/api/notion/pages/*/property"
  to = "/.netlify/functions/notion-page-property?pageId=:splat"
  status = 200
